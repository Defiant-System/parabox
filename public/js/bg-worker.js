let Anim={init(t){this.paused=false},dispatch(t){let e=Anim,s;switch(t.type){case"start":e.cvs=t.canvas;e.ctx=e.cvs.getContext("2d");e.dispatch({type:"create-scene"});e.draw();break;case"stop":case"pause":e.paused=true;break;case"resume":e.paused=false;e.draw();break;case"create-scene":e.boxes=[...Array(17)].map((t=>({x:Utils.random(0,e.cvs.width+100)-50|0,y:Utils.random(0,e.cvs.height-70)+35|0,d:Utils.random(.1,1.25),w:Utils.random(20,60)|0,h:Utils.random(20,60)|0,r:Utils.random(0,Math.PI),rD:Utils.random(.05,.2)})));e.perlin=new ClassicalNoise;e.variation=.0027;e.amp=560;e.maxLines=29;e.variators=[];e.startY=e.cvs.height>>1;for(let t=0,s=0;t<e.maxLines;t++,s+=.025){e.variators[t]=s}e.ctx.fillStyle="#aaddff55";e.ctx.strokeStyle=`#aaddff33`;e.ctx.lineWidth=1;break}},update(t){t.boxes.map((e=>{e.x-=e.d;if(e.x+e.w<-30){e.y=Utils.random(0,t.cvs.height-70)+35|0;e.w=Utils.random(20,60)|0;e.x=t.cvs.width+e.w*2;e.d=Utils.random(.1,1.25)}e.r+=.01}))},draw(){let t=Anim,e=t.cvs,s=t.ctx;s.clearRect(0,0,e.width,e.height);t.boxes.map((t=>{s.save();s.translate(t.x,t.y);s.rotate(t.r);s.fillRect(-t.w>>1,-t.h>>1,t.w,t.h);s.restore()}));for(let i=0;i<=t.maxLines;i++){s.beginPath();s.moveTo(-5,t.startY);for(let r=0;r<e.width;r++){let e=t.perlin.noise(r*t.variation+t.variators[i],r*t.variation,0);s.lineTo(r,t.startY+t.amp*e)}s.stroke();s.closePath();t.variators[i]+=75e-5}if(!t.paused){t.update(t);requestAnimationFrame(t.draw)}}};Anim.init();self.onmessage=t=>Anim.dispatch(t.data);let Utils={random(t,e){return Math.random()*(e-t)+t},calculateDistance(t,e,s,i){let r=t-s,a=e-i;return Math.sqrt(r**2+a**2)}};class ClassicalNoise{constructor(t){if(t==undefined)t=Math;this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]];this.p=[];for(let e=0;e<256;e++){this.p[e]=Math.floor(t.random()*256)}this.perm=[];for(let t=0;t<512;t++){this.perm[t]=this.p[t&255]}}dot(t,e,s,i){return t[0]*e+t[1]*s+t[2]*i}mix(t,e,s){return(1-s)*t+s*e}fade(t){return t*t*t*(t*(t*6-15)+10)}noise(t,e,s){let i=Math.floor(t);let r=Math.floor(e);let a=Math.floor(s);t=t-i;e=e-r;s=s-a;i=i&255;r=r&255;a=a&255;let h=this.perm[i+this.perm[r+this.perm[a]]]%12;let l=this.perm[i+this.perm[r+this.perm[a+1]]]%12;let m=this.perm[i+this.perm[r+1+this.perm[a]]]%12;let d=this.perm[i+this.perm[r+1+this.perm[a+1]]]%12;let o=this.perm[i+1+this.perm[r+this.perm[a]]]%12;let n=this.perm[i+1+this.perm[r+this.perm[a+1]]]%12;let p=this.perm[i+1+this.perm[r+1+this.perm[a]]]%12;let c=this.perm[i+1+this.perm[r+1+this.perm[a+1]]]%12;let f=this.dot(this.grad3[h],t,e,s);let x=this.dot(this.grad3[o],t-1,e,s);let u=this.dot(this.grad3[m],t,e-1,s);let v=this.dot(this.grad3[p],t-1,e-1,s);let g=this.dot(this.grad3[l],t,e,s-1);let w=this.dot(this.grad3[n],t-1,e,s-1);let U=this.dot(this.grad3[d],t,e-1,s-1);let b=this.dot(this.grad3[c],t-1,e-1,s-1);let y=this.fade(t);let M=this.fade(e);let A=this.fade(s);let k=this.mix(f,x,y);let C=this.mix(g,w,y);let L=this.mix(u,v,y);let P=this.mix(U,b,y);let Y=this.mix(k,L,M);let q=this.mix(C,P,M);let D=this.mix(Y,q,A);return D}}